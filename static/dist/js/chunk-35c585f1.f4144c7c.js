(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-35c585f1"],{"11bd":function(e,t,o){},"1a9e":function(e,t,o){"use strict";var r=o("8e8d"),s=o.n(r);s.a},"3b5e":function(e,t,o){"use strict";var r=o("11bd"),s=o.n(r);s.a},"77b8":function(e,t,o){"use strict";o.r(t);var r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("section",{staticClass:"home"},[o("section",{staticClass:"flex flex-wrap"},[o("div",{staticClass:"flex-1"},[o("div",{staticClass:"title flex flex-column mb-30"},[e._m(0),o("p",{staticClass:"fs-14 font-bold"},[e._v(e._s(e.$t("home.Create or import a ClickHouse Cluster")))])]),o("div",{staticClass:"btns flex flex-column width-6"},[o("el-button",{staticClass:"mb-20 fs-18",attrs:{type:"primary",size:"large"},on:{click:function(t){return e.importCk(1)}}},[e._v(e._s(e.$t("home.Create a ClickHouse Cluster")))]),o("el-button",{staticClass:"fs-18",attrs:{type:"primary",size:"large"},on:{click:function(t){return e.importCk(0)}}},[e._v(e._s(e.$t("home.Import a ClickHouse Cluster")))])],1)])]),o("div",{staticClass:"list mt-50"},[o("p",{staticClass:"font-bold mb-10 fs-18"},[e._v(e._s(e.$t("home.All ClickHouse Clusters")))]),o("el-table",{attrs:{data:e.list,border:"","header-cell-class-name":"header-cell-class-name"}},[o("el-table-column",{attrs:{prop:"cluster","show-overflow-tooltip":"",label:e.$t("home.Cluster Name")}}),o("el-table-column",{attrs:{prop:"logic_cluster","show-overflow-tooltip":"",label:e.$t("home.Belongs to Logic")}}),o("el-table-column",{attrs:{prop:"mode","show-overflow-tooltip":"",label:e.$t("home.Mode")}}),o("el-table-column",{attrs:{prop:"isReplica","show-overflow-tooltip":"",label:e.$t("home.Replica")}}),o("el-table-column",{attrs:{prop:"hosts","show-overflow-tooltip":"",label:e.$t("home.ClickHouse Node IP")}}),o("el-table-column",{attrs:{prop:"count","show-overflow-tooltip":"",label:e.$t("home.ClickHouse Node Count")}}),o("el-table-column",{attrs:{prop:"zkNodes","show-overflow-tooltip":"",label:e.$t("home.Zookeeper Node List")}}),o("el-table-column",{attrs:{label:e.$t("home.Actions")},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[o("el-link",{attrs:{type:"primary",underline:"",to:"/clusters/"+r.cluster},on:{click:function(t){return t.preventDefault(),e.toCluster(r)}}},[e._v(e._s(e.$t("home.Go to cluster")))]),o("i",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("common.Delete"),expression:"$t('common.Delete')"}],staticClass:"fa fa-trash pointer fs-18 ml-15",on:{click:function(t){return e.remove(r)}}})]}}])})],1)],1)])},s=[function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("p",{staticClass:"mb-5",staticStyle:{"font-size":"40px"}},[o("i",{staticClass:"fa fa-database"}),o("span",{staticClass:"inline-block ml-10 font-bold"},[e._v("Provision")])])}],a=o("a34a"),l=o.n(a),n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("section",{staticClass:"createCk"},[o("el-form",{ref:"Form",attrs:{model:e.formModel,"label-width":"150px"}},[e.type?o("el-form-item",{attrs:{label:e.$t("home.ClickHouse Version")+":",prop:"packageVersion",required:""}},[o("el-select",{staticClass:"width-350",attrs:{clearable:"",filterable:""},model:{value:e.formModel.packageVersion,callback:function(t){e.$set(e.formModel,"packageVersion",t)},expression:"formModel.packageVersion"}},e._l(e.versionOptions,(function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),o("el-form-item",{attrs:{label:e.$t("home.Cluster Name")+":",prop:"cluster",required:""}},[o("el-input",{staticClass:"width-350",model:{value:e.formModel.cluster,callback:function(t){e.$set(e.formModel,"cluster",t)},expression:"formModel.cluster"}})],1),e.type?o("el-form-item",{attrs:{label:e.$t("home.Logic Name")+":",prop:"logic_cluster"}},[o("el-input",{staticClass:"width-350",model:{value:e.formModel.logic_cluster,callback:function(t){e.$set(e.formModel,"logic_cluster",t)},expression:"formModel.logic_cluster"}})],1):e._e(),e.type?e._e():o("el-form-item",{attrs:{label:e.$t("home.ClickHouse Node IP")+":",prop:"hosts",required:""}},[o("el-input",{staticClass:"width-350",attrs:{type:"textarea",autosize:{minRows:2},placeholder:e.$t("common.placeholderIp")},model:{value:e.formModel.hosts,callback:function(t){e.$set(e.formModel,"hosts",t)},expression:"formModel.hosts"}})],1),o("el-form-item",{attrs:{label:e.$t("home.ClickHouse TCP Port")+":",prop:"port",required:""}},[o("el-input",{staticClass:"width-350",model:{value:e.formModel.port,callback:function(t){e.$set(e.formModel,"port",t)},expression:"formModel.port"}})],1),e.type?o("el-form-item",{attrs:{label:e.$t("home.ClickHouse Node List")+":",prop:"hosts",required:""}},[o("el-input",{staticClass:"width-350",attrs:{type:"textarea",autosize:{minRows:2},placeholder:e.$t("common.placeholderIp")},model:{value:e.formModel.hosts,callback:function(t){e.$set(e.formModel,"hosts",t)},expression:"formModel.hosts"}})],1):e._e(),e.type?o("el-form-item",{attrs:{label:e.$t("home.Replica"),prop:"isReplica"}},[o("el-switch",{model:{value:e.formModel.isReplica,callback:function(t){e.$set(e.formModel,"isReplica",t)},expression:"formModel.isReplica"}})],1):e._e(),o("el-form-item",{attrs:{label:e.$t("home.Zookeeper Node List")+":",prop:"zkNodes",required:""}},[o("el-input",{staticClass:"width-350",attrs:{type:"textarea",autosize:{minRows:2},placeholder:e.$t("common.placeholderIp")},model:{value:e.formModel.zkNodes,callback:function(t){e.$set(e.formModel,"zkNodes",t)},expression:"formModel.zkNodes"}})],1),o("el-form-item",{attrs:{label:e.$t("home.ZooKeeper Port")+":",prop:"zkPort",required:""}},[o("el-input",{staticClass:"width-350",model:{value:e.formModel.zkPort,callback:function(t){e.$set(e.formModel,"zkPort",t)},expression:"formModel.zkPort"}})],1),o("el-form-item",{attrs:{label:e.$t("home.ZK Status Port")+":",prop:"zkStatusPort",required:""}},[o("el-input",{staticClass:"width-350",model:{value:e.formModel.zkStatusPort,callback:function(t){e.$set(e.formModel,"zkStatusPort",t)},expression:"formModel.zkStatusPort"}})],1),e.type?o("el-form-item",{attrs:{label:e.$t("home.Data path")+":",prop:"path",required:""}},[o("el-input",{staticClass:"width-350",model:{value:e.formModel.path,callback:function(t){e.$set(e.formModel,"path",t)},expression:"formModel.path"}})],1):e._e(),o("el-form-item",{attrs:{label:e.$t("home.Cluster Username")+":",prop:"user",required:""}},[o("el-input",{staticClass:"width-350",model:{value:e.formModel.user,callback:function(t){e.$set(e.formModel,"user",t)},expression:"formModel.user"}})],1),o("el-form-item",{attrs:{label:e.$t("home.Cluster Password")+":",prop:"password",required:""}},[o("el-input",{staticClass:"width-350",attrs:{type:"password","show-password":"",autocomplete:"new-password"},model:{value:e.formModel.password,callback:function(t){e.$set(e.formModel,"password",t)},expression:"formModel.password"}})],1),e.type?o("el-form-item",{attrs:{label:e.$t("home.SSH Username")+":",prop:"sshUser",required:""}},[o("el-input",{staticClass:"width-350",model:{value:e.formModel.sshUser,callback:function(t){e.$set(e.formModel,"sshUser",t)},expression:"formModel.sshUser"}})],1):e._e(),e.type?o("el-form-item",{attrs:{label:e.$t("home.Public Key")+":",prop:"usePubkey"}},[o("el-switch",{attrs:{"active-value":!0,"inactive-value":!1},model:{value:e.formModel.usePubkey,callback:function(t){e.$set(e.formModel,"usePubkey",t)},expression:"formModel.usePubkey"}})],1):e._e(),e.type&&!e.formModel.usePubkey?o("el-form-item",{attrs:{label:e.$t("home.SSH Password")+":",prop:"sshPassword"}},[o("el-input",{staticClass:"width-350",attrs:{type:"password","show-password":"",autocomplete:"new-password"},model:{value:e.formModel.sshPassword,callback:function(t){e.$set(e.formModel,"sshPassword",t)},expression:"formModel.sshPassword"}}),o("el-checkbox",{model:{value:e.formModel.savePassword,callback:function(t){e.$set(e.formModel,"savePassword",t)},expression:"formModel.savePassword"}},[e._v(e._s(e.$t("home.Save Password"))+"?")])],1):e._e(),e.type?o("el-form-item",{attrs:{label:e.$t("home.SSH Port")+":",prop:"sshPort",required:""}},[o("el-input",{staticClass:"width-350",model:{value:e.formModel.sshPort,callback:function(t){e.$set(e.formModel,"sshPort",t)},expression:"formModel.sshPort"}})],1):e._e()],1)],1)},i=[],c=o("e621"),u=o("6071"),m=o("e56b"),p=o("7129"),f=o("2332");function d(e){return d="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function h(e,t,o){if(!Object(f["a"])(o))return!1;var r=d(t);return!!("number"==r?Object(m["a"])(o)&&Object(p["a"])(t,o.length):"string"==r&&t in o)&&Object(u["a"])(o[t],e)}var b=h,v=/\s/;function w(e){var t=e.length;while(t--&&v.test(e.charAt(t)));return t}var k=w,$=/^\s+/;function y(e){return e?e.slice(0,k(e)+1).replace($,""):e}var C=y,x=o("1bc6"),M=NaN,P=/^[-+]0x[0-9a-f]+$/i,g=/^0b[01]+$/i,_=/^0o[0-7]+$/i,z=parseInt;function O(e){if("number"==typeof e)return e;if(Object(x["a"])(e))return M;if(Object(f["a"])(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Object(f["a"])(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=C(e);var o=g.test(e);return o||_.test(e)?z(e.slice(2),o?2:8):P.test(e)?M:+e}var S=O,j=1/0,N=17976931348623157e292;function H(e){if(!e)return 0===e?e:0;if(e=S(e),e===j||e===-j){var t=e<0?-1:1;return t*N}return e===e?e:0}var q=H;function D(e){var t=q(e),o=t%1;return t===t?o?t-o:t:0}var I=D,R=Math.ceil,A=Math.max;function V(e,t,o){t=(o?b(e,t,o):void 0===t)?1:A(I(t),0);var r=null==e?0:e.length;if(!r||t<1)return[];var s=0,a=0,l=Array(R(r/t));while(s<r)l[a++]=Object(c["a"])(e,s,s+=t);return l}var U=V,T=o("c949"),L=o("c281");function B(e,t,o,r,s,a,l){try{var n=e[a](l),i=n.value}catch(c){return void o(c)}n.done?t(i):Promise.resolve(i).then(r,s)}function E(e){return function(){var t=this,o=arguments;return new Promise((function(r,s){var a=e.apply(t,o);function l(e){B(a,r,s,l,n,"next",e)}function n(e){B(a,r,s,l,n,"throw",e)}l(void 0)}))}}var Z={props:["type","versionOptions"],data:function(){return{formModel:{packageVersion:"",cluster:"",hosts:"",zkNodes:"",user:"",password:"",sshUser:"",sshPassword:"",sshPort:22,isReplica:!1,port:9e3,zkPort:2181,zkStatusPort:8080,path:"",savePassword:!1,usePubkey:!1}}},methods:{dealShards:function(e,t){var o=this;return E(l.a.mark((function r(){var s;return l.a.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(e){r.next=4;break}return r.abrupt("return",t.map((function(e){return{replicas:[{ip:e}]}})));case 4:if(s=t.length%2,!s){r.next=10;break}return o.$message.warning("hosts字段ip数量有误"),r.abrupt("return",Promise.reject());case 10:return r.abrupt("return",U(t,2).map((function(e){return{replicas:e.map((function(e){return{ip:e}}))}})));case 11:case"end":return r.stop()}}),r)})))()},onOk:function(){var e=this;return E(l.a.mark((function t(){var o,r,s,a,n,i,c,u,m,p,f,d,h,b,v,w,k,$,y;return l.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$refs.Form.validate();case 2:if(o=e.formModel,r=o.packageVersion,s=o.cluster,a=o.logic_cluster,n=o.hosts,i=o.zkNodes,c=o.user,u=o.password,m=o.sshUser,p=o.sshPassword,f=o.sshPort,d=o.isReplica,h=o.port,b=o.zkPort,v=o.zkStatusPort,w=o.path,k=o.savePassword,$=o.usePubkey,e.type){t.next=8;break}return t.next=6,T["a"].importCluster({cluster:s,logic_cluster:a,hosts:Object(L["b"])(Object(L["c"])(n)),port:+h,user:c,password:u,zkNodes:Object(L["b"])(Object(L["c"])(i)),zkPort:+b,zkStatusPort:+v});case 6:t.next=13;break;case 8:return t.next=10,e.dealShards(d,Object(L["b"])(Object(L["c"])(n)));case 10:return y=t.sent,t.next=13,T["a"].createCluster({clickhouse:{ckTcpPort:+h,clusterName:s,logic_cluster:a,shards:y,packageVersion:r,password:u,path:w,user:c,zkNodes:Object(L["b"])(Object(L["c"])(i)),zkPort:+b,zkStatusPort:+v},hosts:Object(L["b"])(Object(L["c"])(n)),user:m,sshPort:+f,usePubkey:$,password:$?null:p,savePassword:$?null:k});case 13:case"end":return t.stop()}}),t)})))()}},components:{}},K=Z,F=(o("3b5e"),o("2877")),J=Object(F["a"])(K,n,i,!1,null,null,null),G=J.exports,Q=o("08ba");function W(e,t){return oe(e)||te(e,t)||Y(e,t)||X()}function X(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Y(e,t){if(e){if("string"===typeof e)return ee(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?ee(e,t):void 0}}function ee(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,r=new Array(t);o<t;o++)r[o]=e[o];return r}function te(e,t){var o=e&&("undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=o){var r,s,a=[],l=!0,n=!1;try{for(o=o.call(e);!(l=(r=o.next()).done);l=!0)if(a.push(r.value),t&&a.length===t)break}catch(i){n=!0,s=i}finally{try{l||null==o["return"]||o["return"]()}finally{if(n)throw s}}return a}}function oe(e){if(Array.isArray(e))return e}function re(e,t,o,r,s,a,l){try{var n=e[a](l),i=n.value}catch(c){return void o(c)}n.done?t(i):Promise.resolve(i).then(r,s)}function se(e){return function(){var t=this,o=arguments;return new Promise((function(r,s){var a=e.apply(t,o);function l(e){re(a,r,s,l,n,"next",e)}function n(e){re(a,r,s,l,n,"throw",e)}l(void 0)}))}}var ae={name:"Home",data:function(){return{list:[],versionOptions:[]}},mounted:function(){this.fetchVersionData(),this.fetchData()},methods:{fetchData:function(){var e=this;return se(l.a.mark((function t(){var o,r;return l.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.list=[],t.next=3,T["a"].getCluster();case 3:o=t.sent,r=o.data.entity,Object.entries(r).forEach((function(t){var o=W(t,2),r=(o[0],o[1]);r.count=r.hosts.length,r.hosts=r.hosts.join(","),r.zkNodes=r.zkNodes.join(","),e.list.unshift(r)}));case 6:case"end":return t.stop()}}),t)})))()},fetchVersionData:function(){var e=this;return se(l.a.mark((function t(){var o,r;return l.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,T["d"].getList();case 2:o=t.sent,r=o.data.entity,e.versionOptions=r.map((function(e){return{value:e,label:e}}));case 5:case"end":return t.stop()}}),t)})))()},importCk:function(e){var t=this;return se(l.a.mark((function o(){var r;return l.a.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return o.next=2,Object(Q["c"])({component:G,props:{title:e?t.$t("home.Create a ClickHouse Cluster"):t.$t("home.Import a ClickHouse Cluster"),width:600,customClass:"create-cluster-modal",cancelText:t.$t("common.Cancel"),okText:e?t.$t("common.Create"):t.$t("common.Import")},data:{type:e,versionOptions:t.versionOptions}});case 2:r=t.type?"创建成功":"导入成功",t.$message.success("".concat(r)),t.fetchData();case 5:case"end":return o.stop()}}),o)})))()},toCluster:function(e){this.$root.clusterBench=e,delete this.$root.clusterBench.count},remove:function(e){var t=this;return se(l.a.mark((function o(){return l.a.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return o.next=2,t.$confirm(t.$t("common.Confirm Delete"),t.$t("common.tips"),{confirmButtonText:t.$t("common.Delete"),cancelButtonText:t.$t("common.Cancel"),text:"warning"});case 2:return o.next=4,T["a"].deleteCluster("".concat(e.cluster));case 4:t.$message.success("".concat(e.cluster," Cluster ").concat(t.$t("common.Delete")).concat(t.$t("common.Success"))),t.fetchData();case 6:case"end":return o.stop()}}),o)})))()}}},le=ae,ne=(o("1a9e"),Object(F["a"])(le,r,s,!1,null,"0dafb34f",null));t["default"]=ne.exports},"8e8d":function(e,t,o){},e621:function(e,t,o){"use strict";function r(e,t,o){var r=-1,s=e.length;t<0&&(t=-t>s?0:s+t),o=o>s?s:o,o<0&&(o+=s),s=t>o?0:o-t>>>0,t>>>=0;var a=Array(s);while(++r<s)a[r]=e[r+t];return a}t["a"]=r}}]);